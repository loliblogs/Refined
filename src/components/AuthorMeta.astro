---
/**
 * 作者信息组件 - 匹配 Concise 主题样式
 */
import { IdentificationCardIcon, MapPinIcon } from '@phosphor-icons/react';

import { getSiteConfig } from '@/config/site.config';
import type { CollectionName } from '@/types/content';

import MathJax from './MathJax.astro';
import SocialLinks from './SocialLinks.astro';

import { Picture } from 'astro:assets';

interface Props {
  collection?: CollectionName;
}

const { collection = 'post' } = Astro.props;

const config = getSiteConfig(collection);
---

<div class="w-full text-center leading-8 text-primary">
  <div class="flex justify-center pb-6">
    <a href={config.author.avatar.href} class="group">
      <div
        class={`
          relative overflow-hidden rounded-full transition-transform
          duration-200 ease-in-out
          group-hover:scale-110
        `}
      >
        <Picture
          src={config.author.avatar.src}
          alt={config.author.avatar.alt}
          width={config.author.avatar.width}
          height={config.author.avatar.height}
          widths={[
            config.author.avatar.width,
            config.author.avatar.width * 1.25,
            config.author.avatar.width * 1.5,
            config.author.avatar.width * 1.75,
            config.author.avatar.width * 2,
            config.author.avatar.width * 2.5,
            config.author.avatar.width * 3.5,
            config.author.avatar.width * 5,
          ]}
          formats={['avif']}
          fallbackFormat="webp"
          sizes={`calc(clamp(1rem, 0.85rem + 0.15vw, 1.25rem) * ${config.author.avatar.width / 16})`}
          priority
        />
        <div
          class={`
            pointer-events-none absolute inset-0 flex items-center
            justify-center bg-black/0
            transition-[background-color,backdrop-filter] duration-200
            ease-in-out
            group-hover:bg-black/20 group-hover:backdrop-blur-[2px]
          `}
        >
          <span
            class={`
              text-white opacity-0 drop-shadow-md transition-opacity
              duration-200 ease-in-out
              group-hover:opacity-100
            `}
          >
            <IdentificationCardIcon size="3rem" weight="duotone" />
          </span>
        </div>
      </div>
    </a>
  </div>

  <MathJax cacheKey={`author-meta-${collection}`}>
    <div class="text-2xl leading-10 text-primary">{config.author.name}</div>
    {config.author.work && (
      <div class="text-base leading-10 text-secondary">{config.author.work}</div>
    )}
    <div class={`
      mt-2 flex items-center justify-center text-sm leading-8 text-secondary
    `}
    >
      <MapPinIcon size="1rem" weight="regular" />
      <span class="ml-1">{config.author.location}</span>
    </div>
  </MathJax>

  {config.links.length > 0 && (
    <SocialLinks links={config.links} />
  )}
</div>
