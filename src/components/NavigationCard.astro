---
import ArrowLeftBold from '@phosphor-icons/core/assets/bold/arrow-left-bold.svg';
import ArrowRightBold from '@phosphor-icons/core/assets/bold/arrow-right-bold.svg';
import { formatDate } from '@/utils/date-helpers';
import { getPostUrl } from '@/utils/collection-paths';

import type { Post, CollectionName } from '@/types/content';

interface Props {
  post: Post;
  direction: 'prev' | 'next';
  collection: CollectionName;
}

const { post, direction, collection } = Astro.props;

const label = direction === 'prev' ? '上一篇' : '下一篇';
---

<a
  href={getPostUrl(post.slug, collection)}
  class:list={[
    `
      group relative block transform overflow-hidden rounded-2xl border-2
      border-line bg-surface p-4 shadow-md transition-transform duration-300
      ease-out
      hover:border-primary hover:shadow-2xl
      max-lg:p-3
      forced-colors:hover:text-[Highlight]
    `,
    {
      'motion-safe:hover:-translate-x-1': direction === 'prev',
      'motion-safe:hover:translate-x-1': direction === 'next',
    },
  ]}
  id={`page${direction}`}
>
  {/* 方向指示 - 使用 flex-row-reverse 消除重复 */}
  <div class:list={[
    'mb-3 flex items-center gap-3',
    { 'flex-row-reverse': direction === 'next' },
  ]}
  >
    <span class="
      flex size-10 shrink-0 items-center justify-center rounded-full border-2
      border-hover bg-hover transition-transform duration-200
      group-hover:scale-110
    "
    >
      <span class="
        text-primary
        forced-colors:group-hover:text-[Highlight]
      "
      >
        {direction === 'prev'
          ? <ArrowLeftBold width="1.25rem" height="1.25rem" />
          : <ArrowRightBold width="1.25rem" height="1.25rem" />}
      </span>
    </span>
    <div class:list={[
      'flex-1',
      { 'text-right': direction === 'next' },
    ]}
    >
      <span class="text-xs font-medium tracking-wider text-secondary uppercase">
        {label}
      </span>
      <div class="mt-0.5 text-xs text-secondary">
        {formatDate(post.date)}
      </div>
    </div>
  </div>

  {/* 文章标题 */}
  <h1 class="
    mb-2 text-xl font-semibold text-primary transition-colors duration-200
    group-hover:text-link
  "
  >
    {post.title}
  </h1>

  {/* 文章描述 */}
  <p class="mb-2 line-clamp-2 text-xs/relaxed text-secondary">
    {post.excerptSource.type === 'fixed'
      ? post.excerptSource.text
      : post.description}
  </p>

  {/* 标签 */}
  {post.tags.length > 0 && (
    <div class="mt-2">
      <div class="flex flex-wrap gap-2">
        {post.tags.slice(0, 3).map(tag => (
          <span class="
            rounded-md bg-surface-aside px-2.5 py-1 text-xs font-medium
            text-secondary transition-colors duration-200
            group-hover:bg-primary/10 group-hover:text-primary
          "
          >
            #
            {tag}
          </span>
        ))}
      </div>
    </div>
  )}
</a>
