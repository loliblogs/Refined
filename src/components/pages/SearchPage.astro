---
/**
 * 搜索页面组件 - 支持多collection
 * 完全兼容原始search.astro的行为
 */
import '@pagefind/component-ui/css';

import BaseLayout from '@/layouts/BaseLayout.astro';
import { getSearchBundlePath, getSearchUrl } from '@/utils/collection-paths';
import PagefindSearch from '../PagefindSearch';
import '@/styles/pagefind.css';

import type { CollectionName } from '@/types/content';

interface Props {
  collection?: CollectionName;
}

const { collection = 'post' } = Astro.props;

// 页面上下文
const pageContext = {
  path: getSearchUrl(collection),
  collection,
  noindex: true,
  preloadSearch: true,
};
---

<BaseLayout title="搜索" pageContext={pageContext}>
  <div class="mb-8">
    <h1 class="text-3xl font-bold">搜索</h1>
  </div>
  <pagefind-config
    bundle-path={getSearchBundlePath(collection)}
    base-url="/"
  />
  <div class="flex flex-col gap-4">
    <div class="[zoom:var(--pf-summary-zoom)]">
      <pagefind-summary />
    </div>
    <div class="[zoom:var(--pf-zoom)]">
      <pagefind-input />
    </div>
    <div class="[zoom:var(--pf-zoom)]">
      <pagefind-keyboard-hints />
    </div>
    <div class="[zoom:var(--pf-zoom)]">
      <pagefind-results />
    </div>
  </div>
  <PagefindSearch client:only="solid-js" />
</BaseLayout>
